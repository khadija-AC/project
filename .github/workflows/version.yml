name: version
on:
    push

jobs:

    commit:
        name: Conventional Commits
        runs-on: ubuntu-latest
        steps:
          - name: Check out Git repository
            uses: actions/checkout@v3
    
          - name: Conventional Commits
            uses: webiny/action-conventional-commits@v1.3.0
            with:
              allowed-commit-types: "feat,fix,chore,docs,style,refactor,perf,test,build,revert,security"

    version:
       name: Gestion Versions
       needs: commit
       runs-on: ubuntu-latest
       steps:

        - name: Check out Git repository
          uses: actions/checkout@v3

        - name: Set up Node.js
          uses: actions/setup-node@v1
          with:
            node-version: 20
     
        - name: identification
          run: |
             git config --global user.email "khadijaaws21@gmail.com"
             git config --global user.name "khadija-AC"

        - name: execute standard-version
          run: npx standard-version

        - name: push changes
          run: git push --follow-tags origin main && npm publish